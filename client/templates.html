<template name="navigation">
	<h1><a href="{{ pathFor 'browse' page=1 }}">eboydb</a>: {{ postsCount }} docs â€“ p{{ currentPage }}/{{ totalPages }}</h1>
	<input type="file" name="myFile" class="myPixInput">
</template>


<template name="browse">
	{{> navigation }}
	<div class="paging">
		<span class="previous">previous</span> | 
		<span class="next">next</span>
	</div>
	<div class="container">
		{{#each showPix}}

			<div class="docbox" style="background-color: {{ this.metadata.backColor }}">
				<div class="docinfo"><span class='remove'>X</span> {{ this.metadata.backColor }} {{ toWidth }}px {{ factor }}x</div>
				<figure>
					<a href="{{ pathFor 'doc' }}"><img src="{{ this.url store='ThumbsPix' }}" width="{{ toWidth }}" /></a>
				</figure>
			</div>

		{{/each}}
	</div>
</template>

<template name="browsethumbs">
	{{> navigation }}
	<div class="paging">
		<span class="previous">previous</span> | 
		<span class="next">next</span>
	</div>
	<div class="container">
		{{#each showPix}}

			<script type="text/javascript">
			
			// generate a new myThumb variable for each thumbnail
			var varbase = 'myThumb';
			this[varbase+'_{{ this._id }}'] = '{{ this._id }}';			
			myThumb_{{ this._id }} = new Image();
			myThumb_{{ this._id }}.src = "{{ this.url store='OriginalPix' }}";

			// console.log('this.type: ' + '{{ this.type }}');
			
			myThumb_{{ this._id }}.onload = function() {
				var canvas = document.getElementById('{{ this._id }}');
				var context = canvas.getContext("2d");			
				// context.fillStyle = '#999999'; //'{{ this.metadata.backColor }}';
				// context.fillRect(0, 0, '{{ scaledSprite.widthDevice }}', '{{ scaledSprite.heightDevice }}');
				context.mozImageSmoothingEnabled = false;
				context.webkitImageSmoothingEnabled = false;
				context.msImageSmoothingEnabled = false;
				context.imageSmoothingEnabled = false;
				context.drawImage(
					myThumb_{{ this._id }},
					{{ scaledSprite.offsetWidth }},
					{{ scaledSprite.offsetHeight }},
					{{ scaledSprite.widthDevice }},
					{{ scaledSprite.heightDevice }}
				);
			}
			</script>

			<div class="docbox" style="background-color: {{ this.metadata.backColor }}">
				<div class="docinfo"><span class='remove'>X</span> {{ this.metadata.backColor }} {{ toWidth }}px {{ scaledSprite.scaleFactor }}x</div>
				<figure>
					<a href="{{ pathFor 'doc' }}">
						<canvas id='{{ this._id }}'
							width="{{ scaledSprite.tnWidthDevice }}"
							height="{{ scaledSprite.tnHeightDevice }}"
							style="width:{{ scaledSprite.tnWidth }}px; height: {{ scaledSprite.tnHeight }}px;">
								This browser does not support HTML5 canvas
						</canvas>
					</a>
				</figure>
			</div>
		{{/each}}

	</div>
</template>


<template name="doc">
	<h1><a href="" class="goBack">eboydb</a>: {{ this._id }} </h1>
	<div class="showDocFull">
		<figure>
			<!-- <img style="background-color: none" src="{{ this.url 	store='OriginalPix' }}" width="{{ this.metadata.width }}" height="{{ this.metadata.height }}" /> -->
			<img style="background-color: none" src="{{ this.url 	store='OriginalPix' }}" width="{{ deviceDimensions.width }}" height="{{ deviceDimensions.height }}" />
			<a href="{{ pathFor 'spriteBox' boxsize='512'}}">
				<img style="background-color: {{ this.metadata.backColor }}" src="{{ this.url store='OriginalPix' }}" width="{{ deviceDimensions.width }}" height="{{ deviceDimensions.height }}" />
			</a>

	<figcaption>
		<ol>
			<li><span class="property">name</span>: {{ this.name }}</li>
			<li><span class="property">uploadedAt</span>: {{this.uploadedAt}}</li>
			<li><span class="property">metadata.width</span>: {{this.metadata.width}}</li>
			<li><span class="property">metadata.height</span>: {{this.metadata.height}}</li>
			<li><span class="property">metadata.copyright</span>: {{this.metadata.copyright}}</li>
			<li><span class="property">metadata.tags</span>: {{this.metadata.tags}}</li>
			<li><span class="property">metadata.backColor</span>: {{ this.metadata.backColor }}</li>
		</ol>
	</figcaption>
		</figure>
		<form>
			<div>tags: <input type="text" name="tags" value="{{this.metadata.tags}}"></div>
			<div>background-color: <input type="text" name="backColor" value="{{this.metadata.backColor}}"></div>
			<input type="submit" name="updatetags">
		</form>
	</div>
</template>